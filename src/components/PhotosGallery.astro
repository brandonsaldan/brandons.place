---
const rotations = ['rotate-2', '-rotate-2', 'rotate-2', 'rotate-2', '-rotate-2'];
const images = Array.from({ length: 23 }, (_, i) => `/photos/image-${i + 1}.jpg`);
---

<div class="mt-16 sm:mt-20">
    <div id="gallery-container" class="hide-scrollbar overflow-x-auto pb-20">
        <div class="flex gap-5 py-4 sm:gap-8">
            {images.map((imageSrc, imageIndex) => (
                <div
                    class={`relative aspect-[9/10] w-44 flex-none overflow-hidden rounded-xl bg-zinc-100 dark:bg-zinc-800 sm:w-72 sm:rounded-2xl ${
                        rotations[imageIndex % rotations.length]
                    }`}
                >
                    <img
                        src={imageSrc}
                        alt=""
                        class="absolute inset-0 h-full w-full object-cover select-none"
                        loading="lazy"
                        draggable="false"
                    />
                </div>
            ))}
        </div>
    </div>
</div>

<style>
    .hide-scrollbar {
        scrollbar-width: none;
        -ms-overflow-style: none;
        -webkit-overflow-scrolling: touch;
    }
    .hide-scrollbar::-webkit-scrollbar {
        display: none;
    }
</style>

<script>
    const slider = document.getElementById('gallery-container');
    
    if (slider) {
        const scrollAmount = window.innerWidth >= 640 ? 288 : 176;
        slider.scrollLeft = scrollAmount / 2;
    }

    let isMouseDown = false;
    let startX: number;
    let scrollLeft: number;

    if (slider) {
        slider.addEventListener('mousedown', (e: MouseEvent) => {
            isMouseDown = true;
            startX = e.pageX - slider.offsetLeft;
            scrollLeft = slider.scrollLeft;
        });

        slider.addEventListener('mousemove', (e: MouseEvent) => {
            if (!isMouseDown) return;
            e.preventDefault();
            const x = e.pageX - slider.offsetLeft;
            const walk = (x - startX);
            slider.scrollLeft = scrollLeft - walk;
        });

        slider.addEventListener('mouseup', () => {
            isMouseDown = false;
        });

        slider.addEventListener('mouseleave', () => {
            isMouseDown = false;
        });
    }
</script>